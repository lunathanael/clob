/**
 * @page copyright
 * Copyright(c) 2025-present, Nathanael Lu.
 * Distributed under the MIT License (http://opensource.org/licenses/MIT)
 */

syntax = "proto3";

package marketmaker;

// Interface exported by the server.
service MarketMaker {
  // A server-to-client streaming RPC.
  //
  // Places an order in the Order Book
  rpc PlaceOrder(PlaceOrderRequest) returns (LimitOrderId) {}

  // Obtains the current information on an order.
  //
  // An empty message with `order_found` set to false is returned
  // if no order was found with `LimitOrderId`.
  rpc GetOrderStatus(GetOrderRequest) returns (LimitOrderInfo) {}

  // Attempts to cancel an ongoing order
  rpc CancelOrder(CancelOrderRequest) returns (CancelOrderResponse) {}
}

enum OrderType {
  Bid = 0;
  Ask = 1;
}

// Information for placing a Limit Order
message PlaceOrderRequest {
  uint32 stock_id = 1;
  uint32 price = 2;
  uint32 quantity = 3;
  OrderType order_type = 4;
}

message GetOrderRequest {
  uint64 order_id = 1;
  OrderType order_type = 2;
}

message CancelOrderRequest {
  uint64 order_id = 1;
  OrderType order_type = 2;
}

message LimitOrderId {
  uint64 order_id = 1;
}

message LimitOrderInfo {
    uint64 order_id = 1;
    uint64 timestamp = 2;
    int64 balance = 3;
    uint32 price = 4;
    uint32 quantity = 5;
    uint32 filled_quantity = 6;
    bool is_cancelled = 7;
    bool order_found = 8;
}

message CancelOrderResponse {
    bool success = 1;
}
